[
  {
    "name": "userinfo_in_url",
    "description": "URL contains userinfo (user:pass@host), a common phishing obfuscation pattern.",
    "severity": "medium",
    "points": 25,
    "match": { "type": "userinfo_present" }
  },
  {
    "name": "ip_literal_host",
    "description": "Host is an IP literal (v4/v6) instead of a domain name.",
    "severity": "low",
    "points": 15,
    "match": { "type": "ip_literal_host" }
  },
  {
    "name": "ip_encoded_host",
    "description": "Host looks like an encoded IP (hex/octal/integer), often used to bypass filters.",
    "severity": "medium",
    "points": 25,
    "match": { "type": "ip_encoded_host" }
  },
  {
    "name": "many_subdomains",
    "description": "Host has an unusually high number of subdomain labels (â‰¥5).",
    "severity": "low",
    "points": 10,
    "match": { "type": "subdomain_count_gte", "min_labels": 5 }
  },
  {
    "name": "punycode_label",
    "description": "Host contains punycode (xn--) labels, which can be used for homograph attacks.",
    "severity": "low",
    "points": 15,
    "match": { "type": "punycode_label" }
  },
  {
    "name": "mixed_script_host",
    "description": "Host appears to mix scripts (e.g., Latin + Cyrillic/Greek), a homograph risk.",
    "severity": "medium",
    "points": 25,
    "match": { "type": "mixed_script_host" }
  },
  {
    "name": "high_entropy_host",
    "description": "Host has high character entropy (random-looking), common in phishing/malware URLs.",
    "severity": "low",
    "points": 15,
    "match": { "type": "entropy_gte", "target": "host", "min_entropy": 3.6, "min_length": 15 }
  },
  {
    "name": "high_entropy_path",
    "description": "Path has high character entropy (random-looking), common in phishing/malware URLs.",
    "severity": "low",
    "points": 10,
    "match": { "type": "entropy_gte", "target": "path", "min_entropy": 3.8, "min_length": 20 }
  },
  {
    "name": "brand_mismatch_microsoft",
    "description": "Host contains 'microsoft' but the registrable domain is not a Microsoft-owned domain.",
    "severity": "medium",
    "points": 20,
    "match": {
      "type": "brand_keyword_mismatch",
      "keyword": "microsoft",
      "allowed_registrable_domains": [
        "microsoft.com",
        "microsoftonline.com",
        "office.com",
        "live.com",
        "windows.net",
        "azure.com"
      ]
    }
  },
  {
    "name": "suspicious_tld",
    "description": "Host TLD is in a suspicious list (weak signal).",
    "severity": "info",
    "points": 5,
    "match": {
      "type": "tld_in",
      "tlds_env": "REPUTATION_SUSPICIOUS_TLDS",
      "tlds": ["zip", "top", "xyz", "click", "icu", "tk", "gq", "ml", "cf", "ga"]
    }
  },
  {
    "name": "open_redirect_params",
    "description": "Query contains common open-redirect parameter names (redirect/url/next/return).",
    "severity": "low",
    "points": 10,
    "match": { "type": "query_param_in", "names": ["redirect", "redirect_url", "url", "next", "return", "return_url", "continue"] }
  },
  {
    "name": "very_long_url",
    "description": "URL is very long (often used to hide malicious parameters).",
    "severity": "info",
    "points": 5,
    "match": { "type": "url_length_gte", "min_length": 200 }
  },
  {
    "name": "very_long_query",
    "description": "Query string is very long (often used to hide malicious parameters).",
    "severity": "info",
    "points": 5,
    "match": { "type": "query_length_gte", "min_length": 120 }
  },
  {
    "name": "download_extension",
    "description": "URL path ends in a high-risk downloadable extension (weighted signal).",
    "severity": "low",
    "points": 15,
    "match": { "type": "path_extension_in", "extensions": ["exe", "js", "iso", "scr", "msi", "docm", "xlsm"] }
  }
]
