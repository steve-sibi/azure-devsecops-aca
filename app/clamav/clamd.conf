# Minimal config suitable for containers (no LocalSocket).
Foreground yes

TCPSocket 3310
TCPAddr 0.0.0.0

DatabaseDirectory /var/lib/clamav
TemporaryDirectory /tmp

PidFile /tmp/clamd.pid

# Allow streaming up to 10MB (worker defaults to 1MB download cap).
StreamMaxLength 10485760

# Guardrails to reduce resource exhaustion (zip bombs, deep recursion, etc).
# Keep these aligned with the worker's MAX_DOWNLOAD_BYTES and CLAMAV_TIMEOUT.
MaxFileSize 10M
MaxScanSize 25M
MaxRecursion 12
MaxFiles 2000
# Milliseconds.
MaxScanTime 8000

LogTime yes
LogFile /var/log/clamav/clamd.log
