# Local run (Docker Compose)
API_KEY=local-dev-key
REQUIRE_API_KEY=true

QUEUE_NAME=tasks
QUEUE_BACKEND=redis
RESULT_BACKEND=redis

# When using Docker Compose, service DNS names work (redis).
# In this compose setup, the worker runs a local clamd sidecar, so use 127.0.0.1.
REDIS_URL=redis://redis:6379/0
REDIS_QUEUE_KEY=queue:tasks
REDIS_DLQ_KEY=dlq:tasks
REDIS_RESULT_PREFIX=scan:
REDIS_RESULT_TTL_SECONDS=0

# Scan engines:
#   - clamav (via clamd TCP microservice)
#   - yara (bundled in the worker container)
#   - heuristic (demo-only fallback)
# You can also run multiple: e.g. "clamav,yara"
SCAN_ENGINE=clamav,yara
CLAMAV_HOST=127.0.0.1
CLAMAV_PORT=3310

# YARA (only used when SCAN_ENGINE includes "yara")
YARA_RULES_PATH=yara-rules/default.yar
YARA_TIMEOUT=5
YARA_MAX_MATCHES=50

# Security defaults
BLOCK_PRIVATE_NETWORKS=true
RATE_LIMIT_RPM=60
RATE_LIMIT_WINDOW_SECONDS=60
