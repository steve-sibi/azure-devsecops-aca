# Local run (Docker Compose)
# Compose reads this; named to avoid collisions with shell-exported API_KEY variables.
ACA_API_KEY=local-dev-key
# Optional: additional API keys (comma-separated) for multi-user scenarios.
# ACA_API_KEYS=key1,key2
REQUIRE_API_KEY=true

QUEUE_NAME=tasks
SCAN_QUEUE_NAME=tasks-scan
QUEUE_BACKEND=redis
RESULT_BACKEND=redis

# Azure Table Storage `details` size guard (optional; default is 60000 on Table backend)
RESULT_DETAILS_MAX_BYTES=60000

# When using Docker Compose, service DNS names work (redis).
REDIS_URL=redis://redis:6379/0
REDIS_QUEUE_KEY=queue:tasks
REDIS_FETCHER_DLQ_KEY=dlq:tasks
REDIS_SCAN_QUEUE_KEY=queue:tasks-scan
REDIS_DLQ_KEY=dlq:tasks-scan
REDIS_RESULT_PREFIX=scan:
REDIS_RESULT_TTL_SECONDS=0

# URL dedupe / cache (optional)
# - Avoids re-scanning the same canonical URL within the TTL window.
# - Set TTLs to 0 to disable.
URL_DEDUPE_TTL_SECONDS=3600
URL_DEDUPE_IN_PROGRESS_TTL_SECONDS=900
URL_DEDUPE_SCOPE=global
URL_DEDUPE_INDEX_PARTITION=urlidx
REDIS_URL_INDEX_PREFIX=urlidx:

# URL scan visibility
# - shared: eligible for URL dedupe/cache reuse (recommended)
# - private: always re-scan; does not populate the shared cache
URL_RESULT_VISIBILITY_DEFAULT=shared

# URL scanning runs built-in "web" analysis only.
# The dashboard also provides external links to URLScan.io and VirusTotal (no API keys needed).

# Security defaults
BLOCK_PRIVATE_NETWORKS=true
RATE_LIMIT_RPM=60
RATE_LIMIT_WINDOW_SECONDS=60

# Web analysis tuning
# WHOIS/RDAP lookups are best-effort and may time out for some registries; increase if needed.
WEB_WHOIS_TIMEOUT_SECONDS=6.0

# Fetcher -> analyzer handoff
ARTIFACT_DELETE_ON_SUCCESS=false

# Optional: capture website screenshots in the worker (Playwright/Chromium).
# Disabled by default; set true to enable.
CAPTURE_SCREENSHOTS=false
SCREENSHOT_FORMAT=jpeg
SCREENSHOT_TIMEOUT_SECONDS=12
SCREENSHOT_VIEWPORT_WIDTH=1280
SCREENSHOT_VIEWPORT_HEIGHT=720
SCREENSHOT_FULL_PAGE=false
SCREENSHOT_JPEG_QUALITY=60
SCREENSHOT_SETTLE_MS=750
SCREENSHOT_LOCALE=en-US
# Optional: override the browser user agent (some sites treat HeadlessChrome differently)
# SCREENSHOT_USER_AGENT=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36
SCREENSHOT_REDIS_PREFIX=screenshot:
SCREENSHOT_CONTAINER=screenshots
SCREENSHOT_TTL_SECONDS=0

# File scanning (ClamAV)
# In Docker Compose, set CLAMAV_HOST=clamav (service name). In Azure Container Apps sidecar mode, use 127.0.0.1.
CLAMAV_HOST=clamav
CLAMAV_PORT=3310
CLAMAV_TIMEOUT_SECONDS=8
FILE_SCAN_MAX_BYTES=10485760
FILE_SCAN_INCLUDE_VERSION=true
