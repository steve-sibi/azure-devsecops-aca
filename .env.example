# Local run (Docker Compose)
API_KEY=local-dev-key
REQUIRE_API_KEY=true

QUEUE_NAME=tasks
SCAN_QUEUE_NAME=tasks-scan
QUEUE_BACKEND=redis
RESULT_BACKEND=redis

# When using Docker Compose, service DNS names work (redis).
REDIS_URL=redis://redis:6379/0
REDIS_QUEUE_KEY=queue:tasks
REDIS_FETCHER_DLQ_KEY=dlq:tasks
REDIS_SCAN_QUEUE_KEY=queue:tasks-scan
REDIS_DLQ_KEY=dlq:tasks-scan
REDIS_RESULT_PREFIX=scan:
REDIS_RESULT_TTL_SECONDS=0

# Scan engines:
#   - reputation (domain/URL heuristics + optional allow/block lists)
#   - content (lightweight response body heuristics)
SCAN_ENGINE=reputation,content
CONTENT_MAX_TEXT_BYTES=200000
CONTENT_MAX_BASE64_MATCH=50000

# URL/domain reputation (only used when SCAN_ENGINE includes "reputation")
# Supports exact hosts, "*.example.com", and ".example.com" suffix matches.
REPUTATION_ALLOWLIST_HOSTS=
REPUTATION_BLOCKLIST_HOSTS=
REPUTATION_MIN_SCORE=60
REPUTATION_BLOCK_ON_MALICIOUS=false
REPUTATION_SUSPICIOUS_TLDS=zip,top,xyz,click,icu,tk,gq,ml,cf,ga
REPUTATION_SUSPICIOUS_KEYWORDS=login,verify,update,secure,account,password,bank

# Demo markers (off by default)
# When enabled, URLs containing the substring "test-malicious" will be treated as malicious by the reputation engine.
ENABLE_DEMO_MARKERS=false

# Security defaults
BLOCK_PRIVATE_NETWORKS=true
RATE_LIMIT_RPM=60
RATE_LIMIT_WINDOW_SECONDS=60

# Fetcher -> analyzer handoff
ARTIFACT_DELETE_ON_SUCCESS=false
