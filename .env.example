# Local run (Docker Compose)
API_KEY=local-dev-key
REQUIRE_API_KEY=true

QUEUE_NAME=tasks
QUEUE_BACKEND=redis
RESULT_BACKEND=redis

# When using Docker Compose, service DNS names work (redis).
# In this compose setup, the worker runs a local clamd sidecar, so use 127.0.0.1.
REDIS_URL=redis://redis:6379/0
REDIS_QUEUE_KEY=queue:tasks
REDIS_DLQ_KEY=dlq:tasks
REDIS_RESULT_PREFIX=scan:
REDIS_RESULT_TTL_SECONDS=0

# Scan engines:
#   - clamav (via clamd TCP microservice)
#   - yara (bundled in the worker container)
#   - reputation (domain/URL heuristics + optional allow/block lists)
#   - heuristic (demo-only fallback)
# You can also run multiple: e.g. "clamav,yara"
SCAN_ENGINE=reputation,clamav,yara
CLAMAV_HOST=127.0.0.1
CLAMAV_PORT=3310

# YARA (only used when SCAN_ENGINE includes "yara")
YARA_RULES_PATH=yara-rules/default.yar
YARA_TIMEOUT=5
YARA_MAX_MATCHES=50
YARA_MAX_STRING_MATCHES=25
YARA_MAX_STRING_LENGTH=200
# Only rules whose names end with _HIGH/_MEDIUM/_LOW/_INFO can be thresholded.
YARA_VERDICT_MIN_SEVERITY=high

# URL/domain reputation (only used when SCAN_ENGINE includes "reputation")
# Supports exact hosts, "*.example.com", and ".example.com" suffix matches.
REPUTATION_ALLOWLIST_HOSTS=
REPUTATION_BLOCKLIST_HOSTS=
REPUTATION_MIN_SCORE=60
REPUTATION_BLOCK_ON_MALICIOUS=false
REPUTATION_SUSPICIOUS_TLDS=zip,top,xyz,click,icu,tk,gq,ml,cf,ga
REPUTATION_SUSPICIOUS_KEYWORDS=login,verify,update,secure,account,password,bank

# Security defaults
BLOCK_PRIVATE_NETWORKS=true
RATE_LIMIT_RPM=60
RATE_LIMIT_WINDOW_SECONDS=60
